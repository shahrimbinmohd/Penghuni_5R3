<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pendaftaran & Carian Kenderaan</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f8f8f8; }
  h2 { color: #333; }
  form, .search-box { background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);}
  label { display: block; margin-top: 10px; }
  input, select, button { width: 100%; padding: 8px; margin-top: 5px; }
  button { background: #4CAF50; color: #fff; border: none; cursor: pointer; }
  button:hover { background: #45a049; }
  .result { background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
</style>
</head>
<body>

<h2>Pendaftaran Maklumat Kenderaan</h2>
<form id="registerForm">
  <label>Unit / Blok:</label>
  <input type="text" name="unit" required>
  
  <label>Nama:</label>
  <input type="text" name="nama" required>
  
  <label>Telefon:</label>
  <input type="text" name="telefon" required>
  
  <label>No Plat:</label>
  <input type="text" name="noPlat" required>
  
  <label>Jenis Kenderaan:</label>
  <select name="jenis" required>
    <option value="">-- Pilih --</option>
    <option value="Kereta">Kereta</option>
    <option value="Motosikal">Motosikal</option>
    <option value="Van">Van</option>
    <option value="Lain-lain">Lain-lain</option>
  </select>

  <button type="submit">Daftar</button>
</form>

<div class="search-box">
  <h2>Carian Kenderaan</h2>
  <input type="text" id="searchPlate" placeholder="Masukkan No Plat...">
  <button id="searchBtn">Cari</button>
</div>

<div id="searchResults" class="result"></div>

<script>
document.getElementById('registerForm').addEventListener('submit', function(e){
  e.preventDefault();
  const formData = Object.fromEntries(new FormData(this).entries());
  
  fetch("https://script.google.com/macros/s/AKfycbzaQ6x1Y-cNuwa0z4957ncwfwRjkgI2vLDHUfd0Om0mzwnXsITq-20NXoIUqlOtrRAM/exec", { // kosong = URL sama dengan web app
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(formData)
  })
  .then(res => res.json())
  .then(data => {
    alert(data.message || 'Pendaftaran berjaya!');
    if (data.ok) e.target.reset();
  })
  .catch(err => alert('Ralat: ' + err));
});

document.getElementById('searchBtn').addEventListener('click', function(){
  const plate = document.getElementById('searchPlate').value.trim();
  if (!plate) return alert('Sila masukkan no plat.');
  
  fetch(`?action=search&plate=${encodeURIComponent(plate)}`)
    .then(res => res.json())
    .then(results => {
      const container = document.getElementById('searchResults');
      container.innerHTML = '';
      if (!results.length) {
        container.innerHTML = '<p>Tiada rekod ditemui.</p>';
        return;
      }
      results.forEach(r => {
        container.innerHTML += `
          <p><strong>${r.noPlat}</strong> - ${r.nama} (${r.unit}), Tel: ${r.telefon}, Jenis: ${r.jenis}</p>
        `;
      });
    })
    .catch(err => alert('Ralat: ' + err));
});
</script>

</body>
</html>
