<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sistem Pendaftaran & Carian Penghuni</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(120deg, #f0f4ff, #e8f5e9);
      padding: 20px;
      color: #333;
    }
    h2 {
      text-align: center;
      color: #2e7d32;
      margin-top: 40px;
    }
    form, .search-section {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      max-width: 550px;
      margin: auto;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: 0.3s;
    }
    form:hover, .search-section:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 6px 0 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
      transition: 0.2s;
    }
    input:focus, select:focus {
      outline: none;
      border-color: #2e7d32;
      box-shadow: 0 0 5px rgba(46,125,50,0.5);
    }
    button {
      background: #2e7d32;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s;
    }
    button:hover {
      background: #1b5e20;
      transform: scale(1.03);
    }
    .vehicle {
      border: 1px solid #c8e6c9;
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 8px;
      background: #f1f8e9;
    }
    .btn-add {
      background: #0288d1;
    }
    .btn-add:hover {
      background: #01579b;
    }
    .result {
      background: #e8f5e9;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      border: 1px solid #c8e6c9;
    }
  </style>
</head>
<body>

<h2>Pendaftaran Kenderaan Penghuni</h2>
<form id="pendaftaranForm">
  <input type="text" name="nama" placeholder="Nama Penuh (Contoh: Ahmad Bin Ali)" required autocomplete="name">
  <input type="tel" name="telefon" placeholder="Nombor Telefon (Contoh: 0123456789)" pattern="[0-9]{9,13}" required>
  
  <select name="blok" required>
    <option value="">Pilih Blok</option>
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
    <option value="D">D</option>
    <option value="E">E</option>
  </select>
  
  <input type="text" name="unit" placeholder="Nombor Unit (Contoh: 5-12)" required>

  <div id="vehicles">
    <div class="vehicle">
      <input type="text" name="noplat[]" placeholder="No Pendaftaran Kenderaan" required>
      <select name="jeniskenderaan[]" required>
        <option value="">Jenis Kenderaan</option>
        <option value="Kereta">Kereta</option>
        <option value="Motosikal">Motosikal</option>
        <option value="Van">Van</option>
      </select>
    </div>
  </div>

  <button type="button" class="btn-add" onclick="tambahKenderaan()">+ Tambah Kenderaan</button>
  <br><br>
  <button type="submit">Daftar</button>
</form>

<h2>Carian Nombor Plat</h2>
<div class="search-section">
  <input type="text" id="searchPlate" placeholder="Masukkan No Plat (Contoh: ABC1234)">
  <button onclick="cariPlat()">Cari</button>
  <div id="result" class="result" style="display:none;"></div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby28dW0T1ZcMF7WOKhBc5iHsMnvzBGa-BwKQdbNWavk2nv0sgq04R_SIZJ8-iRXcq47/exec";

function tambahKenderaan() {
    let container = document.getElementById("vehicles");
    let div = document.createElement("div");
    div.classList.add("vehicle");
    div.innerHTML = `
      <input type="text" name="noplat[]" placeholder="No Pendaftaran Kenderaan" required>
      <select name="jeniskenderaan[]" required>
        <option value="">Jenis Kenderaan</option>
        <option value="Kereta">Kereta</option>
        <option value="Motosikal">Motosikal</option>
        <option value="Van">Van</option>
      </select>
    `;
    container.appendChild(div);
}

document.getElementById("pendaftaranForm").addEventListener("submit", function(e){
    e.preventDefault();

    let noplat = Array.from(document.getElementsByName("noplat[]")).map(el => el.value.trim());
    let jenis = Array.from(document.getElementsByName("jeniskenderaan[]")).map(el => el.value);

    let kenderaanGabung = noplat.map((p, i) => `${p} (${jenis[i]})`).join(", ");

    let formData = {
        nama: this.nama.value,
        telefon: this.telefon.value,
        blok: this.blok.value,
        unit: this.unit.value,
        kenderaan: kenderaanGabung
    };

    fetch(SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify(formData),
        headers: { "Content-Type": "application/json" }
    })
    .then(res => res.json())
    .then(data => {
        alert("Pendaftaran berjaya!");
        document.getElementById("pendaftaranForm").reset();
        document.getElementById("vehicles").innerHTML = `
          <div class="vehicle">
            <input type="text" name="noplat[]" placeholder="No Pendaftaran Kenderaan"
